<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="generator" content="nanoc 3.7.5">
    <link rel="icon" type="image/png" href="/favicon.png">

    <title>Inferical Writings - Quick Look for UIView</title>

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/clean-blog.css" rel="stylesheet">
    <link href="/css/inferis.css" rel="stylesheet">
    <link href="/css/solarized-light.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Inferical Writings</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
              <li>
                  <a href="http://inferis.org">About</a>
              </li>
              <li>
                  <a href="/blog/archives/">Archives</a>
              </li>
              <li>
                  <a href="/feed.atom"><i class="fa fa-rss-square" style="font-size: 200%; position: relative; top: -2px;"></i></a>
              </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="intro-header" style="background-color: #eee;">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Quick Look for UIView</h1>
                    

                    
                      <span class="meta">Posted: March 14, 2014</span>
                    
                </div>
            </div>
        </div>
    </div>
</header>
<script type="text/javascript">

(function() {
    var d = new Date();
    var s = d.getSeconds() + "";
    var m = d.getMinutes() + "";
    var h = d.getHours() + "";

    if (s.length < 2) s = "0" + s;
    if (m.length < 2) m = "0" + m;
    if (h.length < 2) h = "0" + h;

    $(".intro-header").css("background-color", '#' + h + m + s);
})();

</script>


    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                  

<p>Xcode 5.0 introduced an interesting new feature: <a href="https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/CustomClassDisplay_in_QuickLook/Introduction/Introduction.html">Quick Look for variables</a>. Basically, it lets you inspect variables and their contents in a graphical way. This allows for interesting ways of viewing the state of your app.</p>

<p>I've been using the feature quite a bit: it's a great way to inspect images or colors you're using in your app, for example. Works great on attributed strings, too.</p>

<p><img class="img center" src="http://cl.ly/image/0f473u3W2f0L/Image%202014-03-14%20at%2010.00.01%20pm.png" width="500"></p>

<p>Xcode 5.1 improves the feature even further with the addition of <code>debugQuickLookObject</code>. This method allows you to provide quick look content for any of your own classes. A bit like <code>debugDescription</code> but more advanced. I haven't had the time to look further into it.</p>

<!-- more -->

<h2>iOS Dev Weekly to the rescue</h2>

<p>But now it's friday, and reading the latest edition of <a href="http://iosdevweekly.com/issues/137">iOS Dev Weekly</a>, I saw a link titled  <a href="http://useyourloaf.com/blog/2014/03/12/xcode-debugger-quick-look.html">Quick Look on UIViews</a> (the article itself is called <em>Xcode Debugger Quick Look</em>). My interest was immediately peaked: the quick look feature does not provide any specific support for UIViews, and it's been more than once where I had thought: "dammit it want to see what this view looks like". Because now you get this:</p>

<p><img class="img center" src="http://cl.ly/image/100g1D2L0s0v/Image%202014-03-14%20at%2010.24.22%20pm.png" width="500"></p>

<p>Not very useful. So my hopes were high for that article to provide a way to visualise views. And while it provided that, there was no <em>general</em> way to inspect any view. There were specific examples for labels etc, but nothing generic.</p>

<p>So I decided to implement this myself. Include "UIView+DebugQuickLook.m" into your project, and all your views automagically gain <code>debugQuickLookObject</code>. Like this:</p>

<p><img class="img center" src="http://cl.ly/image/0n12410C260c/Image%202014-03-14%20at%2010.29.49%20pm.png" width="300"></p>

<h2>Internals</h2>

<p>So how does this work? It's actually pretty simple:</p>

<ol>
<li>we define a category implementation on <code>UIView</code> (no interface needed since there's no public extensions for UIView).</li>
<li>implement the <code>+load</code> method in that category. This method is called when the class is loaded (the runtime will call load for the class and all its categories having the <code>load</code> method).</li>
<li>In that load method, we invoke another class method that installs the <code>debugQuickLookObject</code>.</li>
<li>We check that <code>debugQuickLookObject</code> isn't already present on <code>UIView</code>. This is in case Apple adds it themselves, or another library implements it for you: we don't want to break things in the future.</li>
<li>After that, we use <code>objc_addClassMethod</code> to add the <code>debugQuickLookObject</code> method to <code>UIView</code>. We use our <code>image_debugQuickLookObject</code> method as a template. This effectively adds a new method to all UIViews.</li>
</ol>

<p>The whole <code>@implementation</code> block is wrapped in an <code>#if DEBUG ... #endif</code> block, since we only want to add this when debugging. There's no need to inject this code into your app when building for production use.</p>

<p>The <code>image_debugQuickLookObject</code> (or <code>debugQuickLookObject</code> once it's been added) method is pretty simple in itself:</p>

<ol>
<li>It creates an image context with the size of the view.</li>
<li>It then tries render the view using <code>drawViewHierarchyInRect:afterScreenUpdates:</code>.</li>
<li>If that failed, it renders again using the view's layer.</li>
<li>It then retrieves the image from the context</li>
<li>and returns it. And that's it.</li>
</ol>

<p>If you want to inspect the "full" code, check out the <a href="https://github.com/Inferis/UIView-DebugQuickLook/blob/master/UIView%2BDebugQuickLook.m">Github repo</a>.</p>

<h2>Get it on the internets</h2>

<p>If you want to integrate this in your own projects, either can download the file from the <a href="https://github.com/Inferis/UIView-DebugQuickLook">Github repo</a> (and add it manually to your project), or use CocoaPods. Just add:</p>

<pre><code class="language-ruby highlight">  <span class="n">pod</span> <span class="s1">'UIView+DebugQuickLook'</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">'https://github.com/Inferis/UIView-DebugQuickLook.git'</span></code></pre>

<p>Enjoy!</p>



                </div>
            </div>
        </div>
    </article>

    <hr>

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://twitter.com/inferis">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://instagram.com/inferis">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/inferis">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://facebook.com/inferis">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="http://www.linkedin.com/in/tomadriaenssen">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://app.net/inferis">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-adn fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://pinboard.in/u:inferis">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-thumb-tack fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                </ul>
                <p class="copyright text-muted">This blog is <a href="https://github.com/Inferis/inferis.github.io">open source</a>.</p>
            </div>
        </div>
    </div>
</footer>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-155493-9', 'auto');
  ga('send', 'pageview');

</script>


</body>

</html>
